import os
from urllib.request import urlopen
from urllib import parse
from urllib import request

import openpyxl as openpyxl
from bs4 import BeautifulSoup
import requests
from openpyxl.styles import PatternFill
from requests.utils import requote_uri
from datetime import datetime
import re
import base.FileOperation as FileOperation
import base.SpiderOperation as SpiderOperation
import WebsIteHandle.WebsiteHandle as WebsiteHandle
import WebsIteHandle.Config_Setting as UserConfig


#提取lib名字作为热词进行搜索的文件路径
# xlsFolder = 'C:\FOSS\SVN'


def main():
    lib_name = UserConfig.FOSSFILE_PATH
    list = FileOperation.readlibname(lib_name)
    # print(list)

    #1 begin将下载的CNNVD数据写入漏洞管理模板中
    if UserConfig.STARTUP_CNNVD:
        WebsiteHandle.DealCNNVDData(list)
    # end将下载的CNNVD数据写入漏洞管理模板中

    # 2 begin将下载xml的CNVD数据写入漏洞管理模板中
    if UserConfig.STARTUP_CNVD:
        WebsiteHandle.DealCNVDData(list)
    # 2 end将下载xml的CNVD数据写入漏洞管理模板中

    # 3 search NVD begin
    if UserConfig.STARTUP_NVD:
        WebsiteHandle.DealNVDData(list)
    # search NVD end

    # 4 search CVE begin
    if UserConfig.STARTUP_CVE:
        WebsiteHandle.DealCVEData(list)
    # search CVE end

    # 5 search CVE_BYXML begin
    if UserConfig.STARTUP_CVE_BYXML:
        WebsiteHandle.DealCVEData_ByXML(list)
    # search CVE end

    # 6 search NVD_BYJSON begin
    if UserConfig.STARTUP_NVD_BYJSON:
        WebsiteHandle.DealNVDData_ByJSON(list)
    # search CVE end
# Press the green button in the gutter to run the script.
if __name__ == '__main__':
    main()

# See PyCharm help at https://www.jetbrains.com/help/pycharm/
